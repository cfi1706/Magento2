# Logs

## Logger injection

Create the file :

`app/code/Test/Jobs/Controller/Job/Testlog.php`

```php
namespace Test\Jobs\Controller\Job;

class Testlog extends \Magento\Framework\App\Action\Action
{
    /**
     * Logger
     *
     * @var LoggerInterface
     */
    protected $_logger;

    /**
     * @param \Magento\Framework\App\Action\Context $context
     * @param \Psr\Log\LoggerInterface $logger
     */
    public function __construct(
        \Magento\Framework\App\Action\Context $context,
        \Psr\Log\LoggerInterface $logger
    )
    {
        $this->_logger = $logger;
        parent::__construct($context);
    }

    public function execute()
    {
        var_dump(get_class($this->_logger));

        $this->_view->loadLayout();
        $this->_view->getLayout()->initMessages();
        $this->_view->renderLayout();
    }
}
```

Our object has got this class besause itâ€™s defined on this file :

```xml
app/etc/di.xml
```

You will see a line like this :

```xml
<preference for="Psr\Log\LoggerInterface" type="Magento\Framework\Logger\Monolog" />
```

## Log levels

Check the code inside the Monolog class:

vendor/monolog/monolog/src/Monolog/Logger.php

You will see some interesting methods :

* addDebug or debug

* addInfo or info

* addNotice or notice

* addWarning or warn or warning

* addError or err or error

* addCritical or crit or critical

* addAlert or alert

* addEmergency or emerg or emergency

Update the controller file:

`app/code/Test/Jobs/Controller/Job/Testlog.php`

```php
namespace Test\Jobs\Controller\Job;

class Testlog extends \Magento\Framework\App\Action\Action
{
    /**
     * Logger
     *
     * @var LoggerInterface
     */
    protected $_logger;

    /**
     * @param \Magento\Framework\App\Action\Context $context
     * @param \Psr\Log\LoggerInterface $logger
     */
    public function __construct(
        \Magento\Framework\App\Action\Context $context,
        \Psr\Log\LoggerInterface $logger
    )
    {
        $this->_logger = $logger;
        parent::__construct($context);
    }

    public function execute()
    {
        $this->_logger->addDebug('My debug log');
        $this->_logger->addInfo('My info log');
        $this->_logger->addNotice('My notice log');
        $this->_logger->addWarning('My warning log');
        $this->_logger->addError('My error log');
        $this->_logger->addCritical('My critical log');
        $this->_logger->addAlert('My alert log');
        $this->_logger->addEmergency('My emergency log');

        $this->_view->loadLayout();
        $this->_view->getLayout()->initMessages();
        $this->_view->renderLayout();
    }
}
```

View log in file:

```xml
var/log/system.log
```

View debug in file:

```xml
var/log/debug.log
```

## Create your own log file with Magento 2

Create the file:

`app/code/Test/Jobs/Logger/Logger.php`

```php
namespace Test\Jobs\Logger;

class Logger extends \Monolog\Logger
{

}
```

Create the file:

`app/code/Test/Jobs/Logger/Handler.php`

```php
namespace Test\Jobs\Logger;

use Monolog\Logger;

class Handler extends \Magento\Framework\Logger\Handler\Base
{
    /**
     * Logging level
     * @var int
     */
    protected $loggerType = Logger::DEBUG;

    /**
     * File name
     * @var string
     */
    protected $fileName = '/var/log/test_jobs.log';
}
```

Change the "di.xml" file, which define dependancy injections :

`app/code/Test/Jobs/etc/di.xml`

Before the closing "config" tag, add this code:

```xml
<?xml version="1.0"?>
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    ...
    <!-- Logger and Handler -->
    <type name="Test\Jobs\Logger\Handler">
        <arguments>
            <argument name="filesystem" xsi:type="object">Magento\Framework\Filesystem\Driver\File</argument>
        </arguments>
    </type>
    <type name="Test\Jobs\Logger\Logger">
        <arguments>
            <argument name="name" xsi:type="string">testJobs</argument>
            <argument name="handlers"  xsi:type="array">
                <item name="system" xsi:type="object">Test\Jobs\Logger\Handler</item>
            </argument>
        </arguments>
    </type>
</config>
```

Edit the file:

`app/code/Test/Jobs/Controller/Job/Testlog.php`

```php
namespace Test\Jobs\Controller\Job;

class Testlog extends \Magento\Framework\App\Action\Action
{
    /**
     * Logger
     *
     * @var LoggerInterface
     */
    protected $_logger;

    /**
     * @param \Magento\Framework\App\Action\Context $context
     * @param \Test\Jobs\Logger\Logger $logger
     */
    public function __construct(
        \Magento\Framework\App\Action\Context $context,
        \Test\Jobs\Logger\Logger $logger
    )
    {
        $this->_logger = $logger;
        parent::__construct($context);
    }

    public function execute()
    {
        $this->_logger->addDebug('My debug log');
        $this->_logger->addInfo('My info log');
        $this->_logger->addNotice('My notice log');
        $this->_logger->addWarning('My warning log');
        $this->_logger->addError('My error log');
        $this->_logger->addCritical('My critical log');
        $this->_logger->addAlert('My alert log');
        $this->_logger->addEmergency('My emergency log');

        $this->_view->loadLayout();
        $this->_view->getLayout()->initMessages();
        $this->_view->renderLayout();
    }
}
```

> If you have an error when you test this code, delete folders "var/generation", "var/cache", and "var/page\_cache"

The logs inside file :

`var/log/test_jobs.log`

The logger name we define inside the "di.xml" file is displayed : "testJobs"

And the debug message is not inside the "debug.log" file because inside our class app/code/Test/Jobs/Logger/Handler.php we set the $loggerType to "Logger::DEBUG"

